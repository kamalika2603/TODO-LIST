<div class="header">
    <div class="title-bar">
        <h1 class="title-text">Manage your time well</h1>
        <div class="logo-container">
            <span class="logo">⚡</span>
        </div>
    </div>
</div>

<!-- Categories Section -->
<div class="categories">
    <div
        class="category-button"
        *ngFor="let category of categories"
        (click)="selectCategory(category.name)"
        [class.active]="category.name === selectedCategory"
    >
        <span class="icon">{{ category.icon }}</span>
        <span class="name">{{ category.name }}</span>
    </div>
</div>

<!-- Tasks Section -->
<div *ngIf="selectedCategory" class="tasks">
    <h2>{{ selectedCategory }} Tasks</h2>
    <ul>
        <li *ngFor="let task of tasks">
            <div class="task-row">
                <!-- Task Details -->
                <div class="task-details">
                    <span class="task-name bold">{{ task.name }}</span>
                    
                    <!-- Conditional Rendering for Description -->
                    <div *ngIf="editingTaskId !== task.id || editingField !== 'description'">
                        {{ task.description }}
                    </div>
                    
                    <!-- Input Box for Editing Description -->
                    <input
                        *ngIf="editingTaskId === task.id && editingField === 'description'"
                        type="text"
                        [value]="task.description"
                        (blur)="saveEdit(task.id, $event.target.value, 'description')"
                    />
                </div>

                <!-- Deadline -->
                <span
                    *ngIf="editingTaskId !== task.id || editingField !== 'deadline'"
                    class="task-deadline"
                >
                    {{ task.deadline ? (task.deadline | date) : '' }}
                </span>
                <input
                    *ngIf="editingTaskId === task.id && editingField === 'deadline'"
                    type="datetime-local"
                    [value]="task.deadline ? (task.deadline | date:'yyyy-MM-ddTHH:mm') : ''"
                    (blur)="saveEdit(task.id, $event.target.value, 'deadline')"
                />

                <!-- Actions -->
                <div class="actions">
                    <button (click)="enterEditMode(task.id, 'description')">✏️</button>
                    <button (click)="enterEditMode(task.id, 'deadline')">📅</button>
                    <button (click)="deleteTask(task.id)">🗑️</button>
                </div>
            </div>
        </li>
    </ul>

    <!-- Add Task Section -->
    <div class="add-task-section">
        <button (click)="showAddTaskInput = true">Add Task</button>
        <div *ngIf="showAddTaskInput">
            <form (ngSubmit)="addTask()">
                <input
                    type="text"
                    [(ngModel)]="newTask.name"
                    name="taskName"
                    placeholder="Type or speak in mic"
                    required
                />
            </form>
            <button (click)="startVoiceInput()">🎙️</button>
        </div>
    </div>
</div>
